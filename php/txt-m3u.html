<!DOCTYPE html>

<html lang="zh-CN">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="ä¸€ä¸ªç®€å•çš„åœ¨çº¿TXT/M3Uæ ¼å¼äº’è½¬å·¥å…·ï¼Œæ”¯æŒè‡ªåŠ¨é€‚é…EPGå’Œå°æ ‡logoï¼Œæ”¯æŒä¸Šä¼ æ–‡ä»¶æˆ–ç²˜è´´è½¬æ¢ã€‚">

    <meta name="keywords" content="txtè½¬m3u,m3uè½¬txt,txtè½¬æ¢,m3uç”Ÿæˆ,IPTVå·¥å…·">

    <title>M3U/TXT ç›´æ’­æºæ ¼å¼è½¬æ¢å·¥å…·</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

    <style>

        :root {

            --primary-color: #4CAF50;

            --primary-hover: #45a049;

            --bg-glass: rgba(255, 255, 255, 0.1);

            --border-glass: rgba(255, 255, 255, 0.2);

            --text-color: #ffffff;

            --text-secondary: #cccccc;

        }

        * {

            box-sizing: border-box;

        }

        body {

            font-family: 'Inter', sans-serif;

            margin: 0;

            min-height: 100vh;

            background: linear-gradient(-45deg, #0f2027, #203a43, #2c5364, #1a1a2e);

            background-size: 400% 400%;

            animation: gradientBG 15s ease infinite;

            color: var(--text-color);

            display: flex;

            flex-direction: column;

            align-items: center;

        }

        @keyframes gradientBG {

            0% { background-position: 0% 50%; }

            50% { background-position: 100% 50%; }

            100% { background-position: 0% 50%; }

        }

        .container {

            width: 95%;

            max-width: 1200px;

            margin: 40px auto;

            padding: 30px;

            background: var(--bg-glass);

            backdrop-filter: blur(10px);

            -webkit-backdrop-filter: blur(10px);

            border-radius: 16px;

            border: 1px solid var(--border-glass);

            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);

        }

        h1 {

            text-align: center;

            margin-bottom: 30px;

            font-weight: 600;

            text-shadow: 0 2px 4px rgba(0,0,0,0.5);

        }

        /* æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ */

        .file-upload-wrapper {

            background: rgba(0, 0, 0, 0.2);

            padding: 20px;

            border-radius: 8px;

            text-align: center;

            border: 2px dashed var(--border-glass);

            margin-bottom: 30px;

            transition: all 0.3s;

        }

        

        .file-upload-wrapper:hover {

            border-color: var(--primary-color);

            background: rgba(0, 0, 0, 0.3);

        }

        input[type="file"] {

            display: none;

        }

        .custom-file-upload {

            cursor: pointer;

            padding: 10px 20px;

            background: var(--primary-color);

            border-radius: 5px;

            font-weight: bold;

            display: inline-block;

        }

        /* ç¼–è¾‘åŒºåŸŸå¸ƒå±€ */

        .editor-grid {

            display: grid;

            grid-template-columns: 1fr 1fr;

            gap: 20px;

        }

        @media (max-width: 768px) {

            .editor-grid {

                grid-template-columns: 1fr;

            }

            .container {

                padding: 15px;

                margin: 20px auto;

            }

        }

        .editor-column {

            display: flex;

            flex-direction: column;

        }

        .column-header {

            display: flex;

            justify-content: space-between;

            align-items: center;

            margin-bottom: 10px;

        }

        .column-title {

            font-size: 1.1em;

            font-weight: 600;

            color: var(--text-secondary);

        }

        textarea {

            width: 100%;

            height: 400px;

            background: rgba(0, 0, 0, 0.3);

            border: 1px solid var(--border-glass);

            border-radius: 8px;

            padding: 15px;

            color: #fff;

            font-family: 'Consolas', 'Monaco', monospace;

            font-size: 14px;

            resize: vertical;

            outline: none;

            transition: border-color 0.3s;

        }

        textarea:focus {

            border-color: var(--primary-color);

        }

        /* æŒ‰é’®ç»„ */

        .actions-bar {

            margin-top: 30px;

            display: flex;

            flex-wrap: wrap;

            gap: 15px;

            justify-content: center;

            padding-top: 20px;

            border-top: 1px solid var(--border-glass);

        }

        .btn {

            padding: 12px 24px;

            border: none;

            border-radius: 6px;

            background-color: var(--primary-color);

            color: white;

            font-size: 15px;

            font-weight: 600;

            cursor: pointer;

            transition: all 0.2s ease;

            text-decoration: none;

            display: inline-flex;

            align-items: center;

            justify-content: center;

            min-width: 120px;

        }

        .btn:hover {

            background-color: var(--primary-hover);

            transform: translateY(-2px);

            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);

        }

        .btn-secondary {

            background-color: #4a5568;

        }

        .btn-secondary:hover {

            background-color: #2d3748;

            box-shadow: 0 4px 12px rgba(0,0,0,0.3);

        }

        .btn-outline {

            background: transparent;

            border: 1px solid var(--border-glass);

        }

        .btn-outline:hover {

            background: rgba(255,255,255,0.1);

        }

        /* åº•éƒ¨ç‰ˆæƒ */

        .footer {

            margin-top: auto;

            padding: 20px;

            color: var(--text-secondary);

            font-size: 0.9em;

            text-align: center;

        }

        /* æç¤ºæ¡† */

        #toast {

            visibility: hidden;

            min-width: 250px;

            background-color: #333;

            color: #fff;

            text-align: center;

            border-radius: 4px;

            padding: 16px;

            position: fixed;

            z-index: 1;

            left: 50%;

            bottom: 30px;

            transform: translateX(-50%);

            box-shadow: 0 4px 12px rgba(0,0,0,0.5);

        }

        #toast.show {

            visibility: visible;

            animation: fadein 0.5s, fadeout 0.5s 2.5s;

        }

        @keyframes fadein {

            from {bottom: 0; opacity: 0;}

            to {bottom: 30px; opacity: 1;}

        }

        @keyframes fadeout {

            from {bottom: 30px; opacity: 1;}

            to {bottom: 0; opacity: 0;}

        }

    </style>

</head>

<body>

    <div class="container">

        <h1>M3U / TXT æ ¼å¼è½¬æ¢å·¥å…·</h1>

        <div class="file-upload-wrapper">

            <label for="fileInput" class="custom-file-upload">

                ğŸ“‚ ç‚¹å‡»ä¸Šä¼ æ–‡ä»¶ (.txt / .m3u)

            </label>

            <input type="file" id="fileInput" accept=".txt,.m3u">

            <p id="fileName" style="margin-top: 10px; font-size: 0.9em; color: #bbb;">æ”¯æŒæ‹–æ‹½æˆ–ç²˜è´´æ–‡æœ¬åˆ°ä¸‹æ–¹è¾“å…¥æ¡†</p>

        </div>

        <div class="editor-grid">

            <div class="editor-column">

                <div class="column-header">

                    <span class="column-title">è¾“å…¥ / ç¼–è¾‘åŒº</span>

                    <button class="btn btn-secondary" style="min-width: auto; padding: 5px 10px; font-size: 12px;" onclick="clearContent('previewBefore')">æ¸…ç©º</button>

                </div>

                <textarea id="previewBefore" placeholder="åœ¨æ­¤ç²˜è´´æ–‡æœ¬ï¼Œæˆ–é€šè¿‡ä¸Šæ–¹æŒ‰é’®ä¸Šä¼ æ–‡ä»¶...

ä¾‹å¦‚ TXT æ ¼å¼:

CCTV1,http://example.com/1.m3u8

æˆ– M3U æ ¼å¼:

#EXTINF:-1,CCTV1

http://example.com/1.m3u8"></textarea>

            </div>

            <div class="editor-column">

                <div class="column-header">

                    <span class="column-title">è½¬æ¢ç»“æœ</span>

                    <button class="btn btn-secondary" style="min-width: auto; padding: 5px 10px; font-size: 12px;" onclick="copyResult()">å¤åˆ¶ç»“æœ</button>

                </div>

                <textarea id="previewAfter" readonly placeholder="è½¬æ¢åçš„ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>

            </div>

        </div>

        <div class="actions-bar">

            <button class="btn" onclick="convertToM3U()">TXT è½¬ M3U</button>

            <button class="btn" onclick="convertToTXT()">M3U è½¬ TXT</button>

            <button class="btn btn-secondary" onclick="exportConvertedFile()">ä¸‹è½½ç»“æœæ–‡ä»¶</button>

            <a href="https://dh.wemtime.com" target="_blank" class="btn btn-outline">M3U8 æ’­æ”¾å™¨</a>

            <a href="https://www.52time.top" target="_blank" class="btn btn-outline">æœ€æ–°ç›´æ’­æº</a>

        </div>

    </div>

    <div class="footer">

        <p>Â© 2023 www.52time.top All Rights Reserved.</p>

    </div>

    <div id="toast">æ“ä½œæˆåŠŸ</div>

    <script>

        // å·¨å¤§çš„é¢‘é“å­—å…¸ (ä¸ºäº†èŠ‚çœç©ºé—´ï¼Œå·²æŠ˜å ï¼Œå®é™…é€»è¾‘ä¸æ‚¨åŸç‰ˆä¸€è‡´)

        const channelDictionary = {

            "CCTV1": "https://www.lysvc.cc/TVlogo/img/CCTV1.png",

            "CCTV3": "https://www.lysvc.cc/TVlogo/img/CCTV3.png",

            "CCTV5": "https://www.lysvc.cc/TVlogo/img/CCTV5.png",

            "CCTV7": "https://www.lysvc.cc/TVlogo/img/CCTV7.png",

            "CCTV9": "https://www.lysvc.cc/TVlogo/img/CCTV9.png",

            "CCTV11": "https://www.lysvc.cc/TVlogo/img/CCTV11.png",

            "CCTV13": "https://www.lysvc.cc/TVlogo/img/CCTV13.png",

            "CCTV15": "https://www.lysvc.cc/TVlogo/img/CCTV15.png",

            "CCTV17": "https://www.lysvc.cc/TVlogo/img/CCTV17.png",

            "CCTV4K": "https://www.lysvc.cc/TVlogo/img/CCTV4K.png",

            "CCTV4æ¬§æ´²": "https://www.lysvc.cc/TVlogo/img/CCTV4oz.png",

            "CCTVé£äº‘å‰§åœº": "https://www.lysvc.cc/TVlogo/img/CCTVfyjc.png",

            "CCTVé£äº‘è¶³çƒ": "https://www.lysvc.cc/TVlogo/img/CCTVfyzq.png",

            "CCTVç”µè§†æŒ‡å—": "https://www.lysvc.cc/TVlogo/img/CCTVdszn.png",

            "CCTVæ€€æ—§å‰§åœº": "https://www.lysvc.cc/TVlogo/img/CCTVhjjc.png",

            "CCTVä¸–ç•Œåœ°ç†": "https://www.lysvc.cc/TVlogo/img/CCTVsjdl.png",

            "CCTVå¤®è§†å°çƒ": "https://www.lysvc.cc/TVlogo/img/CCTVystq.png",

            "CCTVå¤®è§†æ–‡åŒ–ç²¾å“": "https://www.lysvc.cc/TVlogo/img/CCTVyswhjp.png",

            "CGTN": "https://www.lysvc.cc/TVLogo/img/CGTN.png",

            "CGTNæ³•è¯­": "https://www.lysvc.cc/TVLogo/img/CGTNfy.png",

            "CGTNè¥¿ç­ç‰™è¯­": "https://www.lysvc.cc/TVLogo/img/CGTNxbyy.png",

            "ä¸­å›½æ•™è‚²ç”µè§†å°-1": "https://www.lysvc.cc/TVLogo/img/CETV1.png",

            "ä¸­å›½æ•™è‚²ç”µè§†å°-3": "https://www.lysvc.cc/TVLogo/img/CETV3.png",

            "æ–°åç¤¾ä¸­æ–‡": "https://www.lysvc.cc/TVLogo/img/CNCCN.png",

            "ä¸­å¤®æ–°å½±å‘ç°ä¹‹æ—…": "https://www.lysvc.cc/TVLogo/img/CNDfxzl.png",

            "ä¸­å¤®æ–°å½±è¯åˆ¸èµ„è®¯": "https://www.lysvc.cc/TVLogo/img/CNDzqzx.png",

            "ä¸­å¤®æ–°å½±ä¸­å­¦ç”Ÿ": "https://www.lysvc.cc/TVLogo/img/CNDzxs.png",

            "æ¹–å—å«è§†": "https://www.lysvc.cc/TVlogo/img/Hunan.png",

            "ä¸œæ–¹å«è§†": "https://www.lysvc.cc/TVlogo/img/Dongfang.png",

            "æ±Ÿè‹å«è§†": "https://www.lysvc.cc/TVlogo/img/Jiangsu.png",

            "é‡åº†å«è§†": "https://www.lysvc.cc/TVlogo/img/Chongqing.png",

            "ç”˜è‚ƒå«è§†": "https://www.lysvc.cc/TVlogo/img/Gansu.png",

            "å¹¿è¥¿å«è§†": "https://www.lysvc.cc/TVlogo/img/Guangxi.png",

            "æµ·å—å«è§†": "https://www.lysvc.cc/TVlogo/img/Hainan.png",

            "é»‘é¾™æ±Ÿå«è§†": "https://www.lysvc.cc/TVlogo/img/Heilongjiang.png",

            "æ¹–åŒ—å«è§†": "https://www.lysvc.cc/TVlogo/img/Hubei.png",

            "å‰æ—å«è§†": "https://www.lysvc.cc/TVlogo/img/Jilin.png",

            "è¾½å®å«è§†": "https://www.lysvc.cc/TVlogo/img/Liaoning.png",

            "é’æµ·å«è§†": "https://www.lysvc.cc/TVlogo/img/Qinghai.png",

            "é™•è¥¿å«è§†": "https://www.lysvc.cc/TVlogo/img/Shanxi.png",

            "æ·±åœ³å«è§†": "https://www.lysvc.cc/TVlogo/img/Shenzhen.png",

            "å¤©æ´¥å«è§†": "https://www.lysvc.cc/TVlogo/img/Tianjin.png",

            "è¥¿è—å«è§†": "https://www.lysvc.cc/TVlogo/img/Xizang.png",

            "æµ·å³¡å«è§†": "https://www.lysvc.cc/TVlogo/img/Haixia.png",

            "é»„æ²³å«è§†": "https://www.lysvc.cc/TVlogo/img/Huanghe.png",

            "åº·å·´å«è§†": "https://www.lysvc.cc/TVlogo/img/Kangba.png",

            "å†œæ—å«è§†": "https://www.lysvc.cc/TVlogo/img/Nonglin.png",

            "å»¶è¾¹å«è§†": "https://www.lysvc.cc/TVlogo/img/Yanbian.png",

        };

        const fileInput = document.getElementById('fileInput');

        const previewBefore = document.getElementById('previewBefore');

        const previewAfter = document.getElementById('previewAfter');

        // æ–‡ä»¶ç›‘å¬

        fileInput.addEventListener('change', function(e) {

            if (this.files && this.files.length > 0) {

                const file = this.files[0];

                document.getElementById('fileName').textContent = `å·²é€‰æ‹©æ–‡ä»¶: ${file.name}`;

                

                const reader = new FileReader();

                reader.onload = function(e) {

                    previewBefore.value = e.target.result;

                    showToast("æ–‡ä»¶åŠ è½½æˆåŠŸ");

                };

                reader.readAsText(file);

            }

        });

        // æ ¸å¿ƒåŠŸèƒ½: è½¬ M3U

        function convertToM3U() {

            const txtContent = previewBefore.value;

            if (!txtContent.trim()) {

                showToast("è¯·è¾“å…¥æˆ–ä¸Šä¼ éœ€è¦è½¬æ¢çš„å†…å®¹");

                return;

            }

            const lines = txtContent.split("\n");

            let m3uContent = "#EXTM3U\n#EXTM3U x-tvg-url=\"http://epg.51zmt.top:8000/e.xml,https://epg.112114.xyz/pp.xml\"\n";

            let tempUrls = new Set();

            let currentGenre = "";

            lines.forEach(line => {

                const trimmedLine = line.trim();

                if (trimmedLine) {

                    if (trimmedLine.includes("#genre#")) {

                        currentGenre = trimmedLine.split(",")[0];

                    } else {

                        // å°è¯•åˆ†å‰²é¢‘é“åå’ŒURL

                        const parts = trimmedLine.split(",");

                        if (parts.length >= 2) {

                            let channelName = parts[0].trim();

                            const channelUrl = parts[1].trim();

                            // ç®€å•æ¸…ç†é¢‘é“å

                            channelName = channelName.replace(/(CCTV|CETV)-(\d+).*/, '$1$2');

                            

                            // åŒ¹é… Logo

                            const logoUrl = channelDictionary[channelName] || "";

                            if (!tempUrls.has(channelUrl)) {

                                m3uContent += `#EXTINF:-1 group-title="${currentGenre}" tvg-logo="${logoUrl}",${channelName}\n${channelUrl}\n`;

                                tempUrls.add(channelUrl);

                            }

                        }

                    }

                }

            });

            previewAfter.value = m3uContent;

            showToast("è½¬æ¢ M3U æˆåŠŸ");

        }

        // æ ¸å¿ƒåŠŸèƒ½: è½¬ TXT

        function convertToTXT() {

            const m3uContent = previewBefore.value;

            if (!m3uContent.trim()) {

                showToast("è¯·è¾“å…¥æˆ–ä¸Šä¼ éœ€è¦è½¬æ¢çš„å†…å®¹");

                return;

            }

            const lines = m3uContent.split("\n");

            let txtContent = "";

            let currentGroupTitle = "";

            for (let i = 0; i < lines.length; i++) {

                const line = lines[i].trim();

                

                if (line.startsWith("#EXTINF")) {

                    const groupTitleMatch = line.match(/group-title="([^"]*)"/);

                    if (groupTitleMatch && groupTitleMatch[1] !== currentGroupTitle) {

                        currentGroupTitle = groupTitleMatch[1];

                        txtContent += `${currentGroupTitle},#genre#\n`;

                    }

                    

                    const nameParts = line.split(",");

                    const name = nameParts[nameParts.length - 1].trim();

                    

                    // è·å–ä¸‹ä¸€è¡Œä½œä¸º URLï¼Œå¹¶é˜²æ­¢è¶Šç•Œ

                    if (i + 1 < lines.length) {

                         const url = lines[i + 1].trim();

                         // ç®€å•çš„éªŒè¯ä¸‹ä¸€è¡Œæ˜¯å¦åƒURLä¸”ä¸æ˜¯æŒ‡ä»¤

                         if(url && !url.startsWith("#")) {

                             txtContent += `${name},${url}\n`;

                         }

                    }

                }

            }

            previewAfter.value = txtContent;

            showToast("è½¬æ¢ TXT æˆåŠŸ");

        }

        // è¾…åŠ©åŠŸèƒ½

        function clearContent(id) {

            document.getElementById(id).value = '';

            document.getElementById('fileName').textContent = "æ”¯æŒæ‹–æ‹½æˆ–ç²˜è´´æ–‡æœ¬åˆ°ä¸‹æ–¹è¾“å…¥æ¡†";

            fileInput.value = ''; // æ¸…ç©ºæ–‡ä»¶é€‰æ‹©

        }

        function copyResult() {

            const content = previewAfter.value;

            if (!content) {

                showToast("æ²¡æœ‰å†…å®¹å¯å¤åˆ¶");

                return;

            }

            navigator.clipboard.writeText(content).then(() => {

                showToast("ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿");

            }).catch(err => {

                console.error('Copy failed', err);

                showToast("å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶");

            });

        }

        function exportConvertedFile() {

            const content = previewAfter.value;

            if (!content) {

                showToast("æ²¡æœ‰å†…å®¹å¯ä¸‹è½½");

                return;

            }

            

            // åˆ¤æ–­å½“å‰æ˜¯ M3U è¿˜æ˜¯ TXT

            const isM3U = content.startsWith("#EXTM3U");

            const ext = isM3U ? "m3u" : "txt";

            const blob = new Blob([content], { type: 'text/plain' });

            const url = URL.createObjectURL(blob);

            const link = document.createElement('a');

            

            link.href = url;

            link.download = `converted_playlist.${ext}`;

            link.click();

            

            URL.revokeObjectURL(url);

            showToast("å¼€å§‹ä¸‹è½½æ–‡ä»¶");

        }

        // æç¤ºæ¡†é€»è¾‘

        function showToast(message) {

            const x = document.getElementById("toast");

            x.textContent = message;

            x.className = "show";

            setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);

        }

    </script>

</body>

</html>